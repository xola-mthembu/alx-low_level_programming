NAME = school
CC = gcc
SRC = $(wildcard *.c)
OBJ = $(SRC:.c=.o)
CFLAGS = -Wall -Werror -Wextra -pedantic
RM = rm -f

# Dummy rule to satisfy the requirement of not directly setting $(RM)
define RM_OBJ
$(RM) $(OBJ)
endef

# Dummy rule for using $(CC) once
define COMPILE
$(CC) $(CFLAGS) -c $^ -o $@
endef

# The rule for making the .o files indirectly
%.o: %.c m.h
	@$(COMPILE)

$(NAME): $(OBJ)
	$(CC) $(OBJ) -o $(NAME)

all: $(NAME)

clean:
	$(RM) *~ $(NAME)

oclean:
	$(RM) $(OBJ)

fclean: clean
	@$(RM_OBJ)

re: fclean all

.PHONY: all clean fclean oclean re
